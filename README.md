# StarSpin

Игра с вращающимся колесом казино и ставками "звездами". Пользователи могут делать ставки на сегменты колеса и выигрывать в зависимости от того, на какой сегмент укажет стрелка после вращения.

## Технологии

- **Backend**: FastAPI с Python
- **Frontend**: Jinja2 шаблоны, HTML, CSS, JavaScript
- **База данных**: PostgreSQL
- **Управление зависимостями**: Poetry
- **Контейнеризация**: Docker

## Требования

- Docker и Docker Compose (для запуска через контейнеры)
- Python 3.9+ (для локальной разработки)
- Poetry (для локальной разработки)
- Make (опционально, для упрощения запуска)

## Запуск приложения

### Через Make (упрощенный способ)

1. Запуск с Docker:
   ```
   make docker-run
   ```

2. Локальный запуск без Docker:
   ```
   # Установка зависимостей
   make setup
   
   # Запуск PostgreSQL в Docker
   make init-db
   
   # Запуск приложения
   make run
   ```

3. Список всех доступных команд:
   ```
   make help
   ```

### Через Docker Compose (стандартный способ)

1. Клонируйте репозиторий:
   ```
   git clone <url-репозитория>
   cd starspin
   ```

2. Соберите и запустите контейнеры:
   ```
   docker-compose up --build
   ```

3. Откройте в браузере: http://localhost:8000

### Локальный запуск (для разработки)

1. Клонируйте репозиторий:
   ```
   git clone <url-репозитория>
   cd starspin
   ```

2. Установите зависимости с Poetry:
   ```
   poetry install
   ```

3. Запустите PostgreSQL (должен быть установлен локально или через Docker):
   ```
   docker run -d -p 5432:5432 -e POSTGRES_USER=postgres -e POSTGRES_PASSWORD=postgres -e POSTGRES_DB=starspin postgres:14
   ```

4. Запустите приложение:
   ```
   poetry run uvicorn app.main:app --reload
   ```

5. Откройте в браузере: http://localhost:8000

## Функциональность

- **Регистрация и аутентификация**: Пользователи могут создавать аккаунты и входить в систему
- **Баланс звезд**: Каждый новый пользователь получает 1000 звезд при регистрации
- **StarSpin**: Интерактивный элемент с анимацией вращения
- **Ставки**: Пользователи могут делать ставки на сегменты колеса
- **История**: Просмотр истории ставок и выигрышей

## Структура проекта

```
starspin/
├── app/
│   ├── static/             # Статические файлы (CSS, JS)
│   ├── templates/          # Jinja2 шаблоны
│   ├── __init__.py
│   ├── main.py             # Основной файл приложения
│   ├── models.py           # Модели данных
│   ├── schemas.py          # Pydantic схемы
│   ├── database.py         # Настройка базы данных
│   └── auth.py             # Аутентификация
├── tests/                  # Тесты
├── docker-compose.yml      # Docker Compose конфигурация
├── Dockerfile              # Dockerfile
├── pyproject.toml          # Poetry конфигурация
└── README.md
```

## API Endpoints

- `GET /`: Главная страница
- `GET /register`: Страница регистрации
- `POST /register`: Создание нового пользователя
- `GET /login`: Страница входа
- `POST /login`: Аутентификация пользователя
- `GET /game`: Страница игры (требуется аутентификация)
- `POST /spin`: API для вращения колеса (требуется аутентификация)
- `GET /history`: История ставок пользователя (требуется аутентификация)
- `GET /logout`: Выход из системы
